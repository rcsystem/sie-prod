function handleEdit(a){let e=new FormData;e.append("id_folio",a),$.ajax({data:e,url:urls+"requisiciones/editar_requisicion",type:"post",processData:!1,contentType:!1,async:!0,dataType:"json",success:function(e){"error"!=e?(e.forEach(function(e,i){$("#empresa").val(e.empresa_solicitante),$("#centro_costo").val(e.centro_costos),$("#area_operativa").val(e.area_operativas),$("#tipo_personal").val(e.tipo_de_personal),$("#puesto_solicitado").val(e.puesto_solicitado),$("#motivo").val(e.motivo_requisicion),$("#jefe").val(e.jefe_inmediato),$("#remplazo").val(e.colaborador_reemplazo),$("#cotizacion").val(e.cotizacion),$("#periodo").val(e.periodo),$("#genero").val(e.genero_requerido),$("#estado_civil").val(e.estado_civil),$("#edad_minima").val(e.edad_minima),$("#edad_maxima").val(e.edad_maxima),$("#rolar").val(e.rolar_turno),$("#licencia").val(e.licencia_conducir),$("#experiencia").val(e.anios_experiencia),$("#trato").val(e.trato_cli_prov),$("#manejo").val(e.manejo_personal),$("#jornada").val(e.jornada),$("#id_folio").val(a),$("#tipo_personal").val(e.tipo_de_personal),$("#puesto_solicitado").val(e.puesto_solicitado),$("#personas_requeridas").val(e.personas_requeridas),$("#horario_inicial").val(e.horario_inicial),$("#horario_final").val(e.horario_final),$("#salario_inicial").val(e.salario_inicial),$("#salario_final").val(e.salario_final),$("#jefe_inmediato").val(e.jefe_inmediato),$("#estudios").val(e.grado_estudios)}),$("#editarModal").modal("show")):(Swal.fire({icon:"error",title:"Oops...",text:"Algo salió Mal! Contactar con el Administrador"}),console.log("Mal Revisa"))},error:function(a,e,i){Swal.fire({icon:"error",title:"Oops...",text:"Algo salió Mal! Contactar con el Administrador"}),console.log("Mal Revisa entro en el error: "+i)}})}function MASK(a,e,i,o){if("undefined"==o&&(o=!1),o||NUM(e)){dec=0,point=0,t=i.indexOf(".")+1,t&&(dec=i.length-t),dec?(e=NUM(e,dec)+"",t=e.indexOf(".")+1,t?point=e.length-t:e+="."):e=NUM(e,0)+"";for(var t=point;t<dec;t++)e+="0";for(t=e.length,y=i.length,XMASK="";t||y;){if(t){for(;y&&-1=="#0.".indexOf(i.charAt(y-1));)"-"!=e.charAt(t-1)&&(XMASK=i.charAt(y-1)+XMASK),y--;XMASK=e.charAt(t-1)+XMASK,t--}else y&&"$0".indexOf(i.charAt(y-1))+1&&(XMASK=i.charAt(y-1)+XMASK);y&&y--}}else XMASK="";return a&&(a.value=XMASK,NUM(e)<0?a.style.color="#FF0000":a.style.color="#000000"),XMASK}function NUM(s,dec){for(var s=s+"",num="",x=0;x<s.length;x++)c=s.charAt(x),(".-+/*".indexOf(c)+1||" "!=c&&!isNaN(c))&&(num+=c);return isNaN(num)&&(num=eval(num)),num=""==num?0:parseFloat(num),null!=dec?(r=.5,num<0&&(r=-r),e=Math.pow(10,dec>0?dec:0),parseInt(num*e+r)/e):num}function validaNumericos(a){return a.charCode>=48&&a.charCode<=57}$(document).ready(function(){tbl_requisitions=$("#tabla_todas_requisiciones").dataTable({processing:!0,ajax:{method:"post",url:urls+"requisiciones/todas_requisiciones",dataSrc:""},lengthChange:!0,ordering:!0,responsive:!0,autoWidth:!1,rowId:"staffId",dom:"lBfrtip",buttons:[{extend:"excelHtml5",title:"Requisiciones",exportOptions:{columns:[0,1,2,3,4]}}],language:{url:"//cdn.datatables.net/plug-ins/9dcbecd42ad/i18n/Spanish.json"},columns:[{data:"id_folio",title:"FOLIO",className:"text-center"},{data:null,render:function(a,e,i,o){var t=new Date(a.fecha_creacion),n=t.getDate().toString().padStart(2,"0"),r=(t.getMonth()+1).toString().padStart(2,"0"),l=t.getFullYear(),s=t.getHours(),d=t.getMinutes();let c=n+"-"+r+"-"+l,p=s+":"+d;return"0000-00-00"===$.trim(a.fecha_creacion)?"---":` <div class="mr-auto"> ${c} ${p} </div> `},title:"FECHA CREACIÓN",className:"text-center"},{data:null,render:function(a,e,i,o){return a.name+" "+a.surname},title:"USUARIO",className:"text-center"},{data:"depto",title:"DEPARTAMENTO"},{data:null,render:function(a,e,i,o){switch(a.estatus){case"Rechazada":return`<span class="badge badge-danger">${a.estatus}</span>`;case"Autorizada":return`<span class="badge badge-success">${a.estatus}</span>`;default:return`<span class="badge badge-warning">${a.estatus}</span>`}},title:"ESTATUS",className:"text-center"},{data:null,title:"ACCIONES",className:"text-center"}],destroy:"true",columnDefs:[{targets:5,render:function(a,e,i,o){return` <div class=" mr-auto">\n                       <button type="button" class="btn btn-primary btn-sm" title="Editar Requisiciones"  onClick=handleEdit(${a.id_folio})>\n                             <i class="far fa-edit"></i>\n                       </button>\n                       <a href="${urls}requisiciones/ver-requisicion/${$.md5(key+a.id_folio)}" title="Ver Requisición" target="_blank" class="btn btn-info btn-sm">\n                             <i class="fas fa-eye"></i>\n                       </a>\n                     </div> `}}],order:[[0,"DESC"]],createdRow:(a,e)=>{$(a).attr("id","request_"+e.id_folio)}}).DataTable(),$("#tabla_todas_requisiciones thead").addClass("thead-dark text-center")}),$("#actualizar_requisicion").submit(function(a){a.preventDefault(),$("#actualiza_requisicion").prop("disabled",!0);let e=new FormData;e.append("tipo_personal",$("#tipo_personal").val()),e.append("puesto_solicitado",$("#puesto_solicitado").val()),e.append("motivo",$("#motivo").val()),e.append("remplazo",$("#remplazo").val()),e.append("cotizacion",$("#cotizacion").val()),e.append("periodo",$("#periodo").val()),e.append("genero",$("#genero").val()),e.append("estado_civil",$("#estado_civil").val()),e.append("edad_minima",$("#edad_minima").val()),e.append("edad_maxima",$("#edad_maxima").val()),e.append("rolar",$("#rolar").val()),e.append("licencia",$("#licencia").val()),e.append("experiencia",$("#experiencia").val()),e.append("trato",$("#trato").val()),e.append("manejo",$("#manejo").val()),e.append("jornada",$("#jornada").val()),e.append("empresa",$("#empresa").val()),e.append("centro_costo",$("#centro_costo").val()),e.append("area_operativa",$("#area_operativa").val()),e.append("id_folio",$("#id_folio").val()),e.append("tipo_personal",$("#tipo_personal").val()),e.append("puesto_solicitado",$("#puesto_solicitado").val()),e.append("personas_requeridas",$("#personas_requeridas").val()),e.append("estudios",$("#estudios").val()),e.append("salario_inicial",$("#salario_inicial").val()),e.append("salario_final",$("#salario_final").val()),e.append("horario_inicial",$("#horario_inicial").val()),e.append("horario_final",$("#horario_final").val()),e.append("jefe_inmediato",$("#jefe_inmediato").val()),e.append("status",$("#status_req").val()),$.ajax({data:e,url:urls+"requisiciones/actualizar_requisicion",type:"post",processData:!1,contentType:!1,success:function(a){"error"!=a?(setTimeout(function(){tbl_requisitions.ajax.reload(null,!1)},100),$("#actualiza_requisicion").prop("disabled",!1),$("#editarModal").modal("toggle"),Swal.fire("!Los datos se han Actualizado!","","success")):Swal.fire({icon:"error",title:"Oops...",text:"Algo salió Mal! Contactar con el Administrador"})},error:function(a,e,i){Swal.fire({icon:"error",title:"Oops...",text:"Algo salió Mal! Contactar con el Administrador"}),console.log("Mal Revisa entro en el error")}})});